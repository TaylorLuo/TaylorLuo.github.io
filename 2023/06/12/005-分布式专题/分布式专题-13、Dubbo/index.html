<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>分布式专题-13、Dubbo | Taylor</title><meta name="keywords" content="timeline"><meta name="author" content="Taylor Luo"><meta name="copyright" content="Taylor Luo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. Dubbo1.1. 是什么Dubbo 是一款高性能、轻量级的开源 RPC 框架。由 10 层模式构成，整个分层依赖由上至下。通过这张图我们也可以将 Dubbo 理解为三层模式：  第一层的 Business 业务逻辑层由我们自己来提供接口和实现还有一些配置信息。第二层的 RPC 调用的核心层负责封装和实现整个 RPC 的调用过程、负载均衡、集群容错、代理等核心功能。第三层的 Remotin"><meta property="og:type" content="article"><meta property="og:title" content="分布式专题-13、Dubbo"><meta property="og:url" content="https://taylorluo.github.io/2023/06/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-13%E3%80%81Dubbo/index.html"><meta property="og:site_name" content="Taylor"><meta property="og:description" content="1. Dubbo1.1. 是什么Dubbo 是一款高性能、轻量级的开源 RPC 框架。由 10 层模式构成，整个分层依赖由上至下。通过这张图我们也可以将 Dubbo 理解为三层模式：  第一层的 Business 业务逻辑层由我们自己来提供接口和实现还有一些配置信息。第二层的 RPC 调用的核心层负责封装和实现整个 RPC 的调用过程、负载均衡、集群容错、代理等核心功能。第三层的 Remotin"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://picsum.photos/1920/982"><meta property="article:published_time" content="2023-06-12T16:00:00.000Z"><meta property="article:modified_time" content="2023-06-13T23:32:42.689Z"><meta property="article:author" content="Taylor Luo"><meta property="article:tag" content="timeline"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://picsum.photos/1920/982"><link rel="shortcut icon" href="https://gcore.jsdelivr.net/gh/code-anan/image/蜘蛛网万圣节.png"><link rel="canonical" href="https://taylorluo.github.io/2023/06/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-13%E3%80%81Dubbo/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"分布式专题-13、Dubbo",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-06-14 07:32:42"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/self/Kimbiedark.css"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Taylor" type="application/atom+xml"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/index.jpeg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">183</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">85</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://picsum.photos/1920/982')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Taylor</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">分布式专题-13、Dubbo</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-12T16:00:00.000Z" title="发表于 2023-06-13 00:00:00">2023-06-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-13T23:32:42.689Z" title="更新于 2023-06-14 07:32:42">2023-06-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span data-flag-title="分布式专题-13、Dubbo"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2023/06/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-13%E3%80%81Dubbo/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr><h1 id="1-Dubbo"><a href="#1-Dubbo" class="headerlink" title="1. Dubbo"></a>1. Dubbo</h1><h2 id="1-1-是什么"><a href="#1-1-是什么" class="headerlink" title="1.1. 是什么"></a>1.1. 是什么</h2><p>Dubbo 是一款高性能、轻量级的开源 RPC 框架。由 10 层模式构成，整个分层依赖由上至下。通过这张图我们也可以将 Dubbo 理解为三层模式：</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230520214554.png" alt="image.png"></p><p>第一层的 Business 业务逻辑层由我们自己来提供接口和实现还有一些配置信息。<br>第二层的 RPC 调用的核心层负责封装和实现整个 RPC 的调用过程、负载均衡、集群容错、代理等核心功能。<br>第三层的 Remoting 则是对网络传输协议和数据转换的封装。</p><h2 id="1-2-核心能力-特性"><a href="#1-2-核心能力-特性" class="headerlink" title="1.2. 核心能力 (特性)"></a>1.2. 核心能力 (特性)</h2><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230512110804.png" alt="image.png"></p><h2 id="1-3-架构"><a href="#1-3-架构" class="headerlink" title="1.3. 架构"></a>1.3. 架构</h2><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230512111824.png" alt="image.png"></p><h2 id="1-4-协议"><a href="#1-4-协议" class="headerlink" title="1.4. 协议"></a>1.4. 协议</h2><h3 id="1-4-1-Dubbo-协议"><a href="#1-4-1-Dubbo-协议" class="headerlink" title="1.4.1. Dubbo 协议"></a>1.4.1. Dubbo 协议</h3><p>Dubbo 缺省协议采用<span style="background-color:#f0f">单一长连接和 NIO 异步通讯</span>，适合于<span style="background-color:#f0f">小数据量大并发</span>的服务调用，<span style="background-color:#f0f">以及服务消费者机器数远大于服务提供者机器数</span>的情况。</p><p>反之，Dubbo 缺省协议<span style="background-color:red">不适合传送大数据量的服务，比如传文件，传视频等，除非请求量很低。</span></p><p>缺省协议，使用基于 netty <code>3.2.5.Final</code> 和 hessian2 <code>3.2.1-fixed-2(Alibaba embed version)</code> 的 tbremoting 交互。</p><ul><li>连接个数：单连接</li><li>连接方式：长连接</li><li>传输协议：TCP</li><li>传输方式：NIO 异步传输</li><li><span style="background-color:#f0f">序列化：Hessian 二进制序列化</span></li><li>适用范围：<span style="background-color:#f0f">传入传出参数数据包较小（建议小于 100K），消费者比提供者个数多，单一消费者无法压满提供者，尽量不要用 dubbo 协议传输大文件或超大字符串。</span></li><li>适用场景：常规远程服务方法调用</li></ul><h4 id="1-4-1-1-为什么不适合大文件"><a href="#1-4-1-1-为什么不适合大文件" class="headerlink" title="1.4.1.1. 为什么不适合大文件"></a>1.4.1.1. 为什么不适合大文件</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43842093/article/details/126332133">https://blog.csdn.net/qq_43842093/article/details/126332133</a></p><h3 id="1-4-2-其他协议"><a href="#1-4-2-其他协议" class="headerlink" title="1.4.2. 其他协议"></a>1.4.2. 其他协议</h3><p>通信框架方面，Dubbo 默认采用了 Netty 作为通信框架。<br>通信协议方面，Dubbo 除了支持私有的 Dubbo 协议外，还支持 RMI 协议、Hession 协议、HTTP 协议、Thrift 协议等。<br>序列化格式方面，Dubbo 支持多种序列化格式，比如 Dubbo、Hession、JSON、 Kryo、FST 等。</p><h1 id="2-工作原理"><a href="#2-工作原理" class="headerlink" title="2. 工作原理"></a>2. 工作原理</h1><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230530154755.png" alt="image.png"></p><ol><li>服务启动的时候，provider 和 consumer 根据配置信息，连接到注册中心 register，分别向注册中心注册和订阅服务</li><li>register 根据服务订阅关系，返回 provider 信息到 consumer，同时 consumer 会把 provider 信息缓存到本地。如果信息有变更，consumer 会收到来自 register 的推送</li><li>consumer 生成代理对象，同时根据负载均衡策略，选择一台 provider ，同时定时向 monitor 记录接口的调用次数和时间信息</li><li>consumer 拿到代理对象之后，通过代理对象发起接口调用</li><li>provider 收到请求后对数据进行反序列化，然后通过代理调用具体的接口实现</li></ol><h2 id="2-1-负载均衡⭐️🔴"><a href="#2-1-负载均衡⭐️🔴" class="headerlink" title="2.1. 负载均衡⭐️🔴"></a>2.1. 负载均衡⭐️🔴</h2><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002222615305.png" alt="image-20211002222615305"></p><h2 id="2-2-超时与重试"><a href="#2-2-超时与重试" class="headerlink" title="2.2. 超时与重试"></a>2.2. 超时与重试</h2><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327100224.png" alt="image.png"></p><p><span style="background-color:#f0f">默认使用 consumer 中的 timeout 为 1000ms</span></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327095831.png" alt="image.png"></p><p><span style="background-color:#f0f">该数字不包含刚开始的 1 次</span></p><h3 id="2-2-1-配置优先级"><a href="#2-2-1-配置优先级" class="headerlink" title="2.2.1. 配置优先级"></a>2.2.1. 配置优先级</h3><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327100922.png" alt="image.png"><br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327100959.png" alt="image.png"></p><h2 id="2-3-服务容错⭐️🔴"><a href="#2-3-服务容错⭐️🔴" class="headerlink" title="2.3. 服务容错⭐️🔴"></a>2.3. 服务容错⭐️🔴</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1t7411j7P7?p=15">https://www.bilibili.com/video/BV1t7411j7P7?p=15</a></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211018060627326.png" alt="image-20211018060627326"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002223619323.png" alt="image-20211002223619323"></p><h2 id="2-4-服务降级"><a href="#2-4-服务降级" class="headerlink" title="2.4. 服务降级"></a>2.4. 服务降级</h2><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002223240884.png" alt="image-20211002223240884"></p><h2 id="2-5-延迟暴露"><a href="#2-5-延迟暴露" class="headerlink" title="2.5. 延迟暴露"></a>2.5. 延迟暴露</h2><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211018060908252.png" alt="image-20211018060908252"></p><h2 id="2-6-线程模型"><a href="#2-6-线程模型" class="headerlink" title="2.6. 线程模型"></a>2.6. 线程模型</h2><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211018061104632.png" alt="image-20211018061104632"></p><h2 id="3-注册中心"><a href="#3-注册中心" class="headerlink" title="3. 注册中心"></a>3. 注册中心</h2><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214522.jpg" alt="image-20200422011315464"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214516.jpg" alt="image-20200422011522254"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214511.jpg" alt="image-20200422011945717"></p><h4 id="3-1-配置方式"><a href="#3-1-配置方式" class="headerlink" title="3.1. 配置方式"></a>3.1. 配置方式</h4><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214446.jpg" alt="image-20200422084117654"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214424.jpg" alt="image-20200422084312824"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214417.jpg" alt="image-20200422084432841"></p><h1 id="5-源码分析"><a href="#5-源码分析" class="headerlink" title="5. 源码分析"></a>5. 源码分析</h1><h2 id="5-1-标签解析"><a href="#5-1-标签解析" class="headerlink" title="5.1. 标签解析"></a>5.1. 标签解析</h2><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924073517589.png" alt="image-20210924073517589"></p><ol><li><p>启动容器的 main 方法执行时就会调用标签解析器<br>Spring 解析配置文件的总接口：<strong>BeanDefinitionParser</strong>，其中 Dubbo 的实现类为 <strong>DubboBeanDefinitionParser</strong>，其中的方法为 <strong>parse()</strong><br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327215252.jpg" alt="image-20200413112454357"></p></li><li><p>在 DubboBeanDefinitionParser 创建时，有一个 <code>DubboNameSpaceHandler</code> 类的 init() 方法，会给每一个标签注册一个解析器，解析器中就绑定了 class 类别<br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327215246.jpg" alt="image-20200413114008915"></p></li><li><p>在 DubboDefinitionParser 的 parse() 中就能根据标签找到对应的 bean 来封装配置文件中的信息。值得注意的是 service 标签对应的叫 <code>ServiceBean</code>，reference 对应的叫 <code>ReferenceBean</code>，其他的都叫 xxxConfig，为什么与众不同，因为有超能力，分别用于暴露服务和引用服务。</p></li></ol><h2 id="5-2-ServiceBean-版"><a href="#5-2-ServiceBean-版" class="headerlink" title="5.2. ServiceBean 版"></a>5.2. ServiceBean 版</h2><p><a target="_blank" rel="noopener" href="https://blog.51cto.com/u_15281317/2942413">https://blog.51cto.com/u_15281317/2942413</a></p><h2 id="5-3-Dubbo-启动原理-2-7-7-注解版"><a href="#5-3-Dubbo-启动原理-2-7-7-注解版" class="headerlink" title="5.3. Dubbo 启动原理 -2.7.7- 注解版"></a>5.3. Dubbo 启动原理 -2.7.7- 注解版</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7024797126336970766#heading-6">https://juejin.cn/post/7024797126336970766#heading-6</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/yang1060887552/article/details/122836658?spm=1001.2101.3001.6650.5&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-5-122836658-blog-107958704.235%5Ev27%5Epc_relevant_multi_platform_whitelistv3&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-5-122836658-blog-107958704.235%5Ev27%5Epc_relevant_multi_platform_whitelistv3&utm_relevant_index=10">Dubbo源码阅读四：在Spring下DubboBootstrap的启动过程</a></p><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6945839380799946766">https://juejin.cn/post/6945839380799946766</a></p><h3 id="5-3-1-流程图"><a href="#5-3-1-流程图" class="headerlink" title="5.3.1. 流程图"></a>5.3.1. 流程图</h3><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230330223915.png" alt="image.png"></p><h3 id="5-3-2-属性配置解析器-EnableDubboConfig"><a href="#5-3-2-属性配置解析器-EnableDubboConfig" class="headerlink" title="5.3.2. 属性配置解析器 -@EnableDubboConfig"></a>5.3.2. 属性配置解析器 -@EnableDubboConfig</h3><p>当你使用 <code>@EnableDubbo</code> 注解启动 Dubbo 的时候，会加载它的 <code>@EnableDubboConfig</code> 和 <code>@DubboComponentScan</code> 注解，分别用于处理 Dubbo 属性配置和解析 Dubbo 服务</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(&#123;ElementType.TYPE&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Inherited</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-comment">// 处理配置文件中（例如yaml文件）的dubbo配置</span><br><span class="hljs-meta">@EnableDubboConfig</span><br><span class="hljs-comment">// 扫描并解析使用了dubbo注解的组件（例如@Service）</span><br><span class="hljs-meta">@DubboComponentScan</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> EnableDubbo &#123;<br>    ......<br>&#125;<br></code></pre></td></tr></table></figure><p><code>@EnableDubboConfig</code> 和 <code>@DubboComponentScan</code> 注解使用了 Spring 的 <code>@Import</code> 注解来加载具体的实现类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Import(DubboConfigConfigurationRegistrar.class)</span><br><span class="hljs-meta">@Import(DubboComponentScanRegistrar.class)</span><br></code></pre></td></tr></table></figure><h4 id="5-3-2-1-DubboConfigConfigurationRegistrar"><a href="#5-3-2-1-DubboConfigConfigurationRegistrar" class="headerlink" title="5.3.2.1. DubboConfigConfigurationRegistrar"></a>5.3.2.1. DubboConfigConfigurationRegistrar</h4><p><code>DubboConfigConfigurationRegistrar</code> 用于将不同的属性加载到不同的配置文件中<br><code>registerBeans</code> 方法最终通过 <code>ConfigurationBeanBindingsRegister</code> 将解析之后的配置类注册到 <code>BeanDefinitionMap</code><br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401070059.png" alt="image.png"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401070142.png" alt="image.png"><br>最终在 Spring 容器中他们会被初始化成若干对象，例如：<code>dubbo:registry</code> 会转换成 <code>org.apache.dubbo.config.RegistryConfig#0</code></p><h3 id="5-3-3-注解解析器-DubboComponentScan"><a href="#5-3-3-注解解析器-DubboComponentScan" class="headerlink" title="5.3.3. 注解解析器 -@DubboComponentScan"></a>5.3.3. 注解解析器 -@DubboComponentScan</h3><h4 id="5-3-3-1-DubboComponentScanRegistrar"><a href="#5-3-3-1-DubboComponentScanRegistrar" class="headerlink" title="5.3.3.1. DubboComponentScanRegistrar"></a>5.3.3.1. DubboComponentScanRegistrar</h4><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230331083325.png" alt="image.png"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230331083400.png" alt="image.png"></p><p><code>DubboComponentScanRegistrar</code> 主要是用来将 <code>ServiceAnnotationBeanPostProcessor</code> （2.7 以上为 <code>ServiceClassPostProcessor</code>）注册到 <code>BeanDefinitionMap</code> 中。<br>在 Spring 调用 BeanFactory 相关的后置处理器（<code>invokeBeanFactoryPostProcessors</code>）时，会使用 <code>ServiceAnnotationBeanPostProcessor</code> 将 <code>@DubboService</code> 相关注解注册到 <code>BeanDefinitionMap</code></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401070742.png" alt="image.png"><br><span style="background-color:#f0f">在 <code>ServiceClassPostProcessor</code> 中，它注册了一个 dubbo 监听器，用于监听 Spring 容器的刷新、关闭事件，同时也将 <code>@DubboService</code> 注解的类注册到了 <code>BeanDefinitionMap</code> 中</span></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401070910.png" alt="image.png"></p><h3 id="5-3-4-启动"><a href="#5-3-4-启动" class="headerlink" title="5.3.4. 启动"></a>5.3.4. 启动</h3><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7024797126336970766#heading-7">https://juejin.cn/post/7024797126336970766#heading-7</a></p><h4 id="5-3-4-1-ServiceClassPostProcessor"><a href="#5-3-4-1-ServiceClassPostProcessor" class="headerlink" title="5.3.4.1. ServiceClassPostProcessor"></a>5.3.4.1. ServiceClassPostProcessor</h4><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401071355.png" alt="image.png"></p><h5 id="5-3-4-1-1-DubboBootstrapApplicationListener"><a href="#5-3-4-1-1-DubboBootstrapApplicationListener" class="headerlink" title="5.3.4.1.1. DubboBootstrapApplicationListener"></a>5.3.4.1.1. DubboBootstrapApplicationListener</h5><p>伴随着 Spring 容器的启动，在 invokeBeanFactoryPostProcessors 阶段我们注册了 dubbo 相关的组件到 IOC，在 finishBeanFactoryInitialization(beanFactory) Dubbo 的组件被初始化、实例化，最后 Dubbo 通过监听 Spring 事件的方式完成启动器的调用、服务导出等操作<br><code>DubboBootstrap</code> 的启动是通过监听 Spring 事件实现的。Spring 会在容器 Refresh 的最后一步发送一个事件 <code>ContextRefreshedEvent</code>，表示容器刷新完毕。</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401071549.png" alt="image.png"></p><p>对于 <code>ContextRefreshedEvent</code> 事件的监听，最终调用了 dubboBootstrap.start() 方法，在这个方法里，Dubbo 完成了对服务的导出（暴露），导出服务的过程中，<span style="background-color:#f0f">用到了 DUBBO SPI 机制</span></p><h5 id="5-3-4-1-2-ServiceConfig"><a href="#5-3-4-1-2-ServiceConfig" class="headerlink" title="5.3.4.1.2. ServiceConfig"></a>5.3.4.1.2. ServiceConfig</h5><h5 id="5-3-4-1-3-ServiceNameMappingListener"><a href="#5-3-4-1-3-ServiceNameMappingListener" class="headerlink" title="5.3.4.1.3. ServiceNameMappingListener"></a>5.3.4.1.3. ServiceNameMappingListener</h5><p>ServiceNameMapping 及其子类承接了对注册中心的调用，以 nacos 为例调用逻辑如下图<br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230401142610.png" alt="image.png"></p><h2 id="5-4-服务暴露与引用原理-2-7-7-注解版"><a href="#5-4-服务暴露与引用原理-2-7-7-注解版" class="headerlink" title="5.4. 服务暴露与引用原理 -2.7.7- 注解版"></a>5.4. 服务暴露与引用原理 -2.7.7- 注解版</h2><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6874731589243240461">https://juejin.cn/post/6874731589243240461</a></p><h2 id="5-5-服务暴露原理-xml-版⭐️🔴"><a href="#5-5-服务暴露原理-xml-版⭐️🔴" class="headerlink" title="5.5. 服务暴露原理 -xml 版⭐️🔴"></a>5.5. 服务暴露原理 -xml 版⭐️🔴</h2><p><span style="display:none">%%<br>▶1.🏡⭐️◼️【🌈费曼无敌🌈⭐️第一步⭐️】◼️⭐️-point-20230328-0629%%</span>❕ ^gl53ku</p><h3 id="5-5-1-封装-serviceBean"><a href="#5-5-1-封装-serviceBean" class="headerlink" title="5.5.1. 封装 serviceBean"></a>5.5.1. 封装 serviceBean</h3><p>IOC 容器启动时，BeanDefinitionParser 的实现类 DubboBeanDefinitionParser，会解析 dubbo 的标签，而在解析 service 标签时，会将 service 的 Beandefinition 封装成 serviceBean</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327081610.jpg" alt="image-20200413162808979"></p><h3 id="5-5-2-实现了-【InitializingBean】"><a href="#5-5-2-实现了-【InitializingBean】" class="headerlink" title="5.5.2. 实现了 【InitializingBean】"></a>5.5.2. 实现了 【InitializingBean】</h3><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924073843703.png" alt="image-20210924073843703"></p><h4 id="5-5-2-1-afterpropertiesSet-保存信息到-serviceBean"><a href="#5-5-2-1-afterpropertiesSet-保存信息到-serviceBean" class="headerlink" title="5.5.2.1. afterpropertiesSet- 保存信息到 serviceBean"></a>5.5.2.1. afterpropertiesSet- 保存信息到 serviceBean</h4><p>在组件实例化完成，属性设置完之后，调用 <code>afterpropertiesSet()</code> 方法，把配置中的 provider、application、module、registries、monitor、protocols 等的信息保存起来，保存到当前的 serviceBean 里面，最后组装成 URL</p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924080634932.png" alt="image-20210924080634932"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924080658454.png" alt="image-20210924080658454"></p><h3 id="5-5-3-实现了【-ApplicationListener】"><a href="#5-5-3-实现了【-ApplicationListener】" class="headerlink" title="5.5.3. 实现了【 ApplicationListener】"></a>5.5.3. 实现了【 ApplicationListener】</h3><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924074228912.png" alt="image-20210924074228912"></p><p><span style="background-color:red">📢 : 2.7 版本注解版变动挺大，没有实现 ApplicationListener</span><br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230330165227.png" alt="image.png"></p><h4 id="5-5-3-1-onApplicationEvent-加载注册中心的信息"><a href="#5-5-3-1-onApplicationEvent-加载注册中心的信息" class="headerlink" title="5.5.3.1. onApplicationEvent- 加载注册中心的信息"></a>5.5.3.1. onApplicationEvent- 加载注册中心的信息</h4><p>IOC 容器刷新完成，所有对象都创建完成之后，回调 onApplicationEvent()，执行 export、doExport、doExportUrls 等方法，其中会根据不同的协议暴露不同的服务</p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924080346850.png" alt="image-20210924080346850"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924080923918.png" alt="image-20210924080923918"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924080952304.png" alt="image-20210924080952304"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924081059881.png" alt="image-20210924081059881"></p><h4 id="5-5-3-2-将目标服务实现类、接口、URL-等信息封装成-invoker-执行器"><a href="#5-5-3-2-将目标服务实现类、接口、URL-等信息封装成-invoker-执行器" class="headerlink" title="5.5.3.2. 将目标服务实现类、接口、URL 等信息封装成 invoker 执行器"></a>5.5.3.2. 将目标服务实现类、接口、URL 等信息封装成 invoker 执行器</h4><p><span style="background-color:#f0f">使用 proxyFactory 将目标服务实现类、接口、URL 等信息封装成 invoker 执行器</span><br><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924081252224.png" alt="image-20210924081252224"></p><h4 id="5-5-3-3-protocol-export-warpperInvoker-暴露-invoker"><a href="#5-5-3-3-protocol-export-warpperInvoker-暴露-invoker" class="headerlink" title="5.5.3.3. protocol.export(warpperInvoker)- 暴露 invoker"></a>5.5.3.3. protocol.export(warpperInvoker)- 暴露 invoker</h4><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924081305979.png" alt="image-20210924081305979"></p><p>基于 Java 的 SPI 机制，会得到 2 个 protocol</p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924101256388.png" alt="image-20210924101256388"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924092702515.png" alt="image-20210924092702515"></p><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1AP4y1Y7YX?p=28">https://www.bilibili.com/video/BV1AP4y1Y7YX?p=28</a></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002202328113.png" alt="image-20211002202328113"></p><h5 id="5-5-3-3-1-RegistryProtocol-export-暴露-Regisry"><a href="#5-5-3-3-1-RegistryProtocol-export-暴露-Regisry" class="headerlink" title="5.5.3.3.1. RegistryProtocol.export- 暴露 Regisry"></a>5.5.3.3.1. RegistryProtocol.export- 暴露 Regisry</h5><p>export 中有 2 个关键方法：</p><h6 id="5-5-3-3-1-1-doLocalExport"><a href="#5-5-3-3-1-1-doLocalExport" class="headerlink" title="5.5.3.3.1.1. doLocalExport"></a>5.5.3.3.1.1. doLocalExport</h6><p><span style="background-color:#f0f">invokeDelegete 暴露会进入 DubboProtocol.class 中的 export 方法</span><br><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002203437343.png" alt="image-20211002203437343"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924093034314.png" alt="image-20210924093034314"></p><p><span style="background-color:#f0f">invokeDelegete 暴露会进入 DubboProtocol.class 中的 export 方法</span><br><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002203919831.png" alt="image-20211002203919831"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002203950166.png" alt="image-20211002203950166"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002204038478.png" alt="image-20211002204038478"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924093208709.png" alt="image-20210924093208709"></p><p><span style="background-color:#f0f">接下面的 DubboProtocol.export</span></p><h6 id="5-5-3-3-1-2-DubboProtocol-export-暴露-Dubbo-启动-netty-服务器"><a href="#5-5-3-3-1-2-DubboProtocol-export-暴露-Dubbo-启动-netty-服务器" class="headerlink" title="5.5.3.3.1.2. DubboProtocol.export- 暴露 Dubbo- 启动 netty 服务器"></a>5.5.3.3.1.2. DubboProtocol.export- 暴露 Dubbo- 启动 netty 服务器</h6><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924093438794.png" alt="image-20210924093438794"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002204347042.png" alt="image-20211002204347042"></p><p><span style="background-color:#f0f">在 createServer 中启动 netty 服务器，监听 20882 端口</span></p><h4 id="5-5-3-4-ProviderConsumerRegTable-registerProvider-注册服务"><a href="#5-5-3-4-ProviderConsumerRegTable-registerProvider-注册服务" class="headerlink" title="5.5.3.4. ProviderConsumerRegTable.registerProvider- 注册服务"></a>5.5.3.4. ProviderConsumerRegTable.registerProvider- 注册服务</h4><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924093845033.png" alt="image-20210924093845033"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924081709274.png" alt="image-20210924081709274"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211002204723685.png" alt="image-20211002204723685"></p><h2 id="5-6-服务引用原理-xml-版⭐️🔴"><a href="#5-6-服务引用原理-xml-版⭐️🔴" class="headerlink" title="5.6. 服务引用原理 -xml 版⭐️🔴"></a>5.6. 服务引用原理 -xml 版⭐️🔴</h2><p><span style="display:none">%%<br>▶2.🏡⭐️◼️【🌈费曼无敌🌈⭐️第一步⭐️】◼️⭐️-point-20230328-0653%%</span>❕ ^3aliel</p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924084531649.png" alt="image-20210924084531649"></p><h3 id="5-6-1-实现了-【FactoryBean】"><a href="#5-6-1-实现了-【FactoryBean】" class="headerlink" title="5.6.1. 实现了 【FactoryBean】"></a>5.6.1. 实现了 【FactoryBean】</h3><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924100429599.png" alt="image-20210924100429599"></p><ol><li>解析 reference 注解时，发现引用 UserService，就需要在容器中找，因为 ReferenceBean 实现了 FactoryBean，所以调用 getObject 方法</li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924100827788.png" alt="image-20210924100827788"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924100802949.png" alt="image-20210924100802949"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003070252288.png" alt="image-20211003070252288"></p><ol start="2"><li>在 get() 方法中调用了创建代理的 <code>createProxy()</code> 方法，在这个方法里有用到了通过 SPI 方式加载的 Protocol 类<br>map 中存放的是 reference 标签中的属性，用来创建代理类，然后调用 refer，doRefer，subscribe 等关键方法</li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003070217503.png" alt="image-20211003070217503"></p><ol start="3"><li>与暴露方法同样的，引用方法也有 2 个实现，分别是 DubboProtocol 和 RegistryProtocol 中的 refer() 方法</li></ol><p><code>urls</code> 是注册中心的地址<br><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003070628762.png" alt="image-20211003070628762"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924101141683.png" alt="image-20210924101141683"></p><h3 id="5-6-2-RegistryProtocol-refer"><a href="#5-6-2-RegistryProtocol-refer" class="headerlink" title="5.6.2. RegistryProtocol.refer"></a>5.6.2. RegistryProtocol.refer</h3><ol start="4"><li>先调用 RegistryProtocol 中的 refer() 方法，在该方法里到注册中心订阅服务，获取服务信息。</li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924110432057.png" alt="image-20210924110432057"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924110754573.png" alt="image-20210924110754573"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924110832104.png" alt="image-20210924110832104"></p><p><span style="background-color:#f0f">subscribe 方法会调用 dubboProtocol.refer</span></p><h3 id="5-6-3-DubboProtocol-refer"><a href="#5-6-3-DubboProtocol-refer" class="headerlink" title="5.6.3. DubboProtocol.refer"></a>5.6.3. DubboProtocol.refer</h3><ol start="5"><li>在订阅服务的方法中调用了 DubboProtocol 的 refer() 方法，方法中 getClients() 方法中创建客户端。<br><span style="background-color:#f0f">getClients()</span> → <span style="background-color:#f0f">initClient()</span></li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924084254521.png" alt="image-20210924084254521"></p><p><span style="background-color:#f0f">Exchanges.connect(url,xxx)</span></p><ol start="6"><li><span style="background-color:#f0f">创建 netty 的客户端，然后将带有连接属性的 invoker 返回</span></li><li><span style="background-color:#f0f">最后，将 invoker 注册到 ProviderConsumerRegTable 中，注册地址为订阅地址</span></li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924111102833.png" alt="image-20210924111102833"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924111128709.png" alt="image-20210924111128709"></p><h2 id="5-7-服务调用原理-xml-版"><a href="#5-7-服务调用原理-xml-版" class="headerlink" title="5.7. 服务调用原理 -xml 版"></a>5.7. 服务调用原理 -xml 版</h2><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924085205572.png" alt="image-20210924085205572"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924111722548.png" alt="image-20210924111722548"></p><h3 id="5-7-1-进入-InvokerInvocationHandler"><a href="#5-7-1-进入-InvokerInvocationHandler" class="headerlink" title="5.7.1. 进入 InvokerInvocationHandler"></a>5.7.1. 进入 InvokerInvocationHandler</h3><ol><li>代理对象层层封装了 Invoker 对象，里面是一些真正要执行的方法<br><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924111756013.png" alt="image-20210924111756013"></li></ol><h3 id="5-7-2-执行-new-RpcInvocation-方法"><a href="#5-7-2-执行-new-RpcInvocation-方法" class="headerlink" title="5.7.2. 执行 new RpcInvocation 方法"></a>5.7.2. 执行 new RpcInvocation 方法</h3><ol start="2"><li>可以在刚开始给代理对象加一些 filter，比如 cache、mock(比如服务降级) 功能</li><li>其中 InvokerInvocationHanlder 中的 invoke() 方法先到 MockClusterInvoker 类中，这个类可以封装多个 Invoker 对象，比如 failover、failback 功能的 Invoker<br>首先会进入 MockClusterInvoker 中，获取失败容错信息</li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003072302993.png" alt="image-20211003072302993"></p><h3 id="5-7-3-获取负载均衡机制"><a href="#5-7-3-获取负载均衡机制" class="headerlink" title="5.7.3. 获取负载均衡机制"></a>5.7.3. 获取负载均衡机制</h3><ol start="4"><li>多个 Invoker 可以经过通过 SPI 获取到的负载均衡机制进行负载均衡<br>在注册中心找想要执行的方法列表，如果是多个则获取负载均衡机制，然后执行 doInvoker</li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003071436483.png" alt="image-20211003071436483"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924111843322.png" alt="image-20210924111843322"></p><ol start="5"><li>最终底层真正执行方法的 Invoker 是 DubboInvoker，通过 client 调用底层 Netty 客户端进行交互<br>doInvoke 方法进入 FailoverClusterInvoker 中，随机选择一个 Invoker，然后执行 invoker.invoke</li></ol><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003072550600.png" alt="image-20211003072550600"></p><h3 id="5-7-4-经过多个-filter"><a href="#5-7-4-经过多个-filter" class="headerlink" title="5.7.4. 经过多个 filter"></a>5.7.4. 经过多个 filter</h3><p>invoker 是封装的 filter，会经过多个 filter</p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003084214043.png" alt="image-20211003084214043"></p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003082843646.png" alt="image-20211003082843646"></p><h3 id="5-7-5-DubboInvoker-方法中的-doInvoke-方法"><a href="#5-7-5-DubboInvoker-方法中的-doInvoke-方法" class="headerlink" title="5.7.5. DubboInvoker 方法中的 doInvoke 方法"></a>5.7.5. DubboInvoker 方法中的 doInvoke 方法</h3><p>经过多个 filter 之后，是 DubboInvoker 方法中的 doInvoke 方法，真正执行功能的方法</p><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20210924112129947.png" alt="image-20210924112129947"></p><h3 id="5-7-6-currentClient-request"><a href="#5-7-6-currentClient-request" class="headerlink" title="5.7.6. currentClient.request"></a>5.7.6. currentClient.request</h3><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003084855353.png" alt="image-20211003084855353"></p><h1 id="6-分层设计"><a href="#6-分层设计" class="headerlink" title="6. 分层设计"></a>6. 分层设计</h1><p><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003102405068.png" alt="image-20211003102405068"><br><img src="https://github.com/TaylorLuo/typora-imgs/raw/master/img/image-20211003102603060.png" alt="image-20211003102603060"></p><h1 id="7-协议"><a href="#7-协议" class="headerlink" title="7. 协议"></a>7. 协议</h1><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214815.jpg" alt="image-20200422012747019"><br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214810.jpg" alt="image-20200422012807396"></p><h1 id="8-与-SpringBoot-整合"><a href="#8-与-SpringBoot-整合" class="headerlink" title="8. 与 SpringBoot 整合"></a>8. 与 SpringBoot 整合</h1><p>SpringBoot 与 dubbo 整合的三种方式：</p><p>1）、导入 dubbo-starter，在 application.properties 配置属性，使用@Service【暴露服务】使用@Reference【引用服务】</p><p>2）、保留 dubbo xml 配置文件; 导入 dubbo-starter，使用@ImportResource 导入 dubbo 的配置文件即可</p><p>3）、使用注解 API 的方式：将每一个组件手动创建到容器中,让 dubbo 来扫描其他的组件</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214642.jpg" alt="image-20200422000348930"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230327214636.jpg" alt="image-20200422000305379"></p><h1 id="9-Dubbo-SPI-与-JDK-SPI-区别"><a href="#9-Dubbo-SPI-与-JDK-SPI-区别" class="headerlink" title="9. Dubbo SPI 与 JDK SPI 区别"></a>9. Dubbo SPI 与 JDK SPI 区别</h1><p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6872138926216511501">https://juejin.cn/post/6872138926216511501</a></p><h1 id="10-面试题"><a href="#10-面试题" class="headerlink" title="10. 面试题"></a>10. 面试题</h1><h2 id="10-1-与-SpringCloud-的区别"><a href="#10-1-与-SpringCloud-的区别" class="headerlink" title="10.1. 与 SpringCloud 的区别"></a>10.1. 与 SpringCloud 的区别</h2><a href="/2023/05/11/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-16%E3%80%81SpringCloud/" title="分布式专题-16、SpringCloud">分布式专题-16、SpringCloud</a><h2 id="10-2-动态感知服务下线"><a href="#10-2-动态感知服务下线" class="headerlink" title="10.2. 动态感知服务下线"></a>10.2. 动态感知服务下线</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Z44y1372E/?spm_id_from=333.788&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204">https://www.bilibili.com/video/BV1Z44y1372E/?spm_id_from=333.788&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204</a></p><h2 id="10-3-容错机制"><a href="#10-3-容错机制" class="headerlink" title="10.3. 容错机制"></a>10.3. 容错机制</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1hP4y1u77c/?spm_id_from=333.788&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204">https://www.bilibili.com/video/BV1hP4y1u77c/?spm_id_from=333.788&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204</a></p><h2 id="10-4-对-Dubbo-的理解"><a href="#10-4-对-Dubbo-的理解" class="headerlink" title="10.4. 对 Dubbo 的理解"></a>10.4. 对 Dubbo 的理解</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1FU4y1K7C7/?spm_id_from=333.788&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204">https://www.bilibili.com/video/BV1FU4y1K7C7/?spm_id_from=333.788&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204</a></p><h2 id="10-5-文字面试题"><a href="#10-5-文字面试题" class="headerlink" title="10.5. 文字面试题"></a>10.5. 文字面试题</h2><p>[[Dubbo面试题 47道.pdf]]</p><h1 id="11-参考与感谢"><a href="#11-参考与感谢" class="headerlink" title="11. 参考与感谢"></a>11. 参考与感谢</h1><h2 id="11-1-Dubbo-教程-雷丰阳-尚硅谷"><a href="#11-1-Dubbo-教程-雷丰阳-尚硅谷" class="headerlink" title="11.1. Dubbo 教程 _ 雷丰阳 _ 尚硅谷"></a>11.1. Dubbo 教程 _ 雷丰阳 _ 尚硅谷</h2><h3 id="11-1-1-视频"><a href="#11-1-1-视频" class="headerlink" title="11.1.1. 视频"></a>11.1.1. 视频</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Gb411T7Ha?p=12">https://www.bilibili.com/video/BV1Gb411T7Ha?p=12</a></p><h3 id="11-1-2-资料"><a href="#11-1-2-资料" class="headerlink" title="11.1.2. 资料"></a>11.1.2. 资料</h3><p>注解版</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">/Volumes/Seagate Bas/<span class="hljs-number">001</span>-study/语言工具/Dubbo/课件、资料/课件<br></code></pre></td></tr></table></figure><h2 id="11-2-黑马程序员"><a href="#11-2-黑马程序员" class="headerlink" title="11.2. 黑马程序员"></a>11.2. 黑马程序员</h2><h3 id="11-2-1-视频"><a href="#11-2-1-视频" class="headerlink" title="11.2.1. 视频"></a>11.2.1. 视频</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VE411q7dX?p=8&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204">https://www.bilibili.com/video/BV1VE411q7dX?p=8&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204</a></p><h3 id="11-2-2-资料"><a href="#11-2-2-资料" class="headerlink" title="11.2.2. 资料"></a>11.2.2. 资料</h3><p>非注解版：Spring、SpringMVC 整合</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">/Users/Enterprise/<span class="hljs-number">0003</span>-Architecture/<span class="hljs-number">005</span>-分布式专题/<span class="hljs-number">2</span>、分布式开发框架Dubbo/资料--分布式开发框架Dubbo<br></code></pre></td></tr></table></figure><h2 id="11-3-微服务-dubbo-和-springcloud-如何抉择？"><a href="#11-3-微服务-dubbo-和-springcloud-如何抉择？" class="headerlink" title="11.3. 微服务 dubbo 和 springcloud 如何抉择？"></a>11.3. 微服务 dubbo 和 springcloud 如何抉择？</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1rJ411t7MF?p=5">https://www.bilibili.com/video/BV1rJ411t7MF?p=5</a></p><h2 id="11-4-其他"><a href="#11-4-其他" class="headerlink" title="11.4. 其他"></a>11.4. 其他</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">/Users/taylor/Nutstore Files/Obsidian_data/pages/<span class="hljs-number">002</span>-schdule/<span class="hljs-number">001</span>-Arch/<span class="hljs-number">001</span>-Subject/<span class="hljs-number">013</span>-DemoCode/JavaYouth/docs/dubbo-sourcecode-v1<br></code></pre></td></tr></table></figure><h2 id="11-5-技术文章摘抄"><a href="#11-5-技术文章摘抄" class="headerlink" title="11.5. 技术文章摘抄"></a>11.5. 技术文章摘抄</h2><h3 id="11-5-1-视频"><a href="#11-5-1-视频" class="headerlink" title="11.5.1. 视频"></a>11.5.1. 视频</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Bc411V7AR?p=19&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204">https://www.bilibili.com/video/BV1Bc411V7AR?p=19&amp;vd_source=c5b2d0d7bc377c0c35dbc251d95cf204</a></p><h3 id="11-5-2-文档"><a href="#11-5-2-文档" class="headerlink" title="11.5.2. 文档"></a>11.5.2. 文档</h3><p><a target="_blank" rel="noopener" href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Dubbo%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB%E4%B8%8E%E5%AE%9E%E6%88%98-%E5%AE%8C/24%20%20%E4%BB%8E%20Protocol%20%E8%B5%B7%E6%89%8B%EF%BC%8C%E7%9C%8B%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%BC%95%E7%94%A8%E7%9A%84%E5%85%A8%E6%B5%81%E7%A8%8B%EF%BC%88%E4%B8%8A%EF%BC%89.md">看服务暴露和服务引用的全流程</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">/Volumes/Seagate Bas/<span class="hljs-number">001</span>-ArchitectureRoad/<span class="hljs-number">000</span>-极客时间/<span class="hljs-number">31</span>-从<span class="hljs-number">0</span>开始学微服务/<span class="hljs-number">03</span>-模块二 落地微服务 (<span class="hljs-number">14</span>讲)/<span class="hljs-number">14</span>丨开源RPC框架如何选型？.pdf<br></code></pre></td></tr></table></figure><h2 id="11-6-网络笔记"><a href="#11-6-网络笔记" class="headerlink" title="11.6. 网络笔记"></a>11.6. 网络笔记</h2><p>[[Dubbo基础及原理机制 - 胡小华 - 博客园]]</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://taylorluo.github.io">Taylor Luo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://taylorluo.github.io/2023/06/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-13%E3%80%81Dubbo/">https://taylorluo.github.io/2023/06/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-13%E3%80%81Dubbo/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://taylorluo.github.io" target="_blank">Taylor</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/timeline/">timeline</a></div><div class="post_share"><div class="social-share" data-image="https://picsum.photos/1920/982" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/06/12/011-%E9%9D%A2%E8%AF%95%E9%A2%98%E4%B8%93%E9%A2%98/%E9%9D%A2%E8%AF%95%E4%B8%93%E9%A2%98-6%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/"><img class="prev-cover" src="https://picsum.photos/1920/982" onerror='onerror=null,src="/null"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">面试专题-6、分布式组件</div></div></a></div><div class="next-post pull-right"><a href="/2023/06/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86-10%E3%80%81%E9%99%90%E6%B5%81%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7(%E6%9C%8D%E5%8A%A1%E4%BF%9D%E6%8A%A4)-Sentinel/"><img class="next-cover" src="https://unpkg.com/justlovesmile-img/cover2.jpg" onerror='onerror=null,src="/null"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">服务治理-10、限流熔断降级(服务保护)-Sentinel</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/02/06/001-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%93%E9%A2%98/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-1%E3%80%81%E7%9B%B8%E5%85%B3%E5%90%8D%E8%AF%8D/" title="计算机基础-基本原理-1、相关名词"><img class="cover" src="https://picsum.photos/1920/952" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-07</div><div class="title">计算机基础-基本原理-1、相关名词</div></div></a></div><div><a href="/2023/03/27/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/JDK-1%E3%80%81SPI/" title="框架源码专题-JDK-1、SPI"><img class="cover" src="https://unpkg.com/justlovesmile-img/cover5.JPG" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-28</div><div class="title">框架源码专题-JDK-1、SPI</div></div></a></div><div><a href="/2023/03/18/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-9%E3%80%81SQL%E5%BA%94%E7%94%A8%E4%BC%98%E5%8C%96/" title="框架源码专题-MySQL-9、SQL应用优化"><img class="cover" src="https://picsum.photos/1920/1086" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-19</div><div class="title">框架源码专题-MySQL-9、SQL应用优化</div></div></a></div><div><a href="/2023/01/28/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/Spring-7%E3%80%81%E6%89%A9%E5%B1%95%E7%82%B9/" title="框架源码专题-Spring-7、扩展点"><img class="cover" src="https://picsum.photos/1920/992" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-29</div><div class="title">框架源码专题-Spring-7、扩展点</div></div></a></div><div><a href="/2023/01/22/003-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E4%B8%93%E9%A2%98/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E4%B8%93%E9%A2%98-%E5%9F%BA%E7%A1%80-19%E3%80%81Queue/" title="并发编程专题-基础-19、Queue"><img class="cover" src="https://unpkg.com/justlovesmile-img/cover3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-23</div><div class="title">并发编程专题-基础-19、Queue</div></div></a></div><div><a href="/2023/03/08/006-%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98%E4%B8%93%E9%A2%98/%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98%E4%B8%93%E9%A2%98-%E5%9F%BA%E7%A1%80-1%E3%80%81%E6%9E%B6%E6%9E%84%E6%BC%94%E8%BF%9B/" title="架构实战专题-基础-1、架构演进"><img class="cover" src="https://picsum.photos/1920/1083" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-09</div><div class="title">架构实战专题-基础-1、架构演进</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/index.jpeg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Taylor Luo</div><div class="author-info__description">人生海海 不忘初心</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">183</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">85</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Dubbo"><span class="toc-text">1. Dubbo</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">1.1. 是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E6%A0%B8%E5%BF%83%E8%83%BD%E5%8A%9B-%E7%89%B9%E6%80%A7"><span class="toc-text">1.2. 核心能力 (特性)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%9E%B6%E6%9E%84"><span class="toc-text">1.3. 架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%8D%8F%E8%AE%AE"><span class="toc-text">1.4. 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-1-Dubbo-%E5%8D%8F%E8%AE%AE"><span class="toc-text">1.4.1. Dubbo 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E9%80%82%E5%90%88%E5%A4%A7%E6%96%87%E4%BB%B6"><span class="toc-text">1.4.1.1. 为什么不适合大文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-2-%E5%85%B6%E4%BB%96%E5%8D%8F%E8%AE%AE"><span class="toc-text">1.4.2. 其他协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">2. 工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E2%AD%90%EF%B8%8F%F0%9F%94%B4"><span class="toc-text">2.1. 负载均衡⭐️🔴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E8%B6%85%E6%97%B6%E4%B8%8E%E9%87%8D%E8%AF%95"><span class="toc-text">2.2. 超时与重试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-%E9%85%8D%E7%BD%AE%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">2.2.1. 配置优先级</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%9C%8D%E5%8A%A1%E5%AE%B9%E9%94%99%E2%AD%90%EF%B8%8F%F0%9F%94%B4"><span class="toc-text">2.3. 服务容错⭐️🔴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7"><span class="toc-text">2.4. 服务降级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E5%BB%B6%E8%BF%9F%E6%9A%B4%E9%9C%B2"><span class="toc-text">2.5. 延迟暴露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="toc-text">2.6. 线程模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83"><span class="toc-text">3. 注册中心</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="toc-text">3.1. 配置方式</span></a></li></ol></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-text">5. 源码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E6%A0%87%E7%AD%BE%E8%A7%A3%E6%9E%90"><span class="toc-text">5.1. 标签解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-ServiceBean-%E7%89%88"><span class="toc-text">5.2. ServiceBean 版</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-Dubbo-%E5%90%AF%E5%8A%A8%E5%8E%9F%E7%90%86-2-7-7-%E6%B3%A8%E8%A7%A3%E7%89%88"><span class="toc-text">5.3. Dubbo 启动原理 -2.7.7- 注解版</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-1-%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-text">5.3.1. 流程图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-2-%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE%E8%A7%A3%E6%9E%90%E5%99%A8-EnableDubboConfig"><span class="toc-text">5.3.2. 属性配置解析器 -@EnableDubboConfig</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-2-1-DubboConfigConfigurationRegistrar"><span class="toc-text">5.3.2.1. DubboConfigConfigurationRegistrar</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-3-%E6%B3%A8%E8%A7%A3%E8%A7%A3%E6%9E%90%E5%99%A8-DubboComponentScan"><span class="toc-text">5.3.3. 注解解析器 -@DubboComponentScan</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-3-1-DubboComponentScanRegistrar"><span class="toc-text">5.3.3.1. DubboComponentScanRegistrar</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-4-%E5%90%AF%E5%8A%A8"><span class="toc-text">5.3.4. 启动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-4-1-ServiceClassPostProcessor"><span class="toc-text">5.3.4.1. ServiceClassPostProcessor</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-4-1-1-DubboBootstrapApplicationListener"><span class="toc-text">5.3.4.1.1. DubboBootstrapApplicationListener</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-4-1-2-ServiceConfig"><span class="toc-text">5.3.4.1.2. ServiceConfig</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-3-4-1-3-ServiceNameMappingListener"><span class="toc-text">5.3.4.1.3. ServiceNameMappingListener</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2%E4%B8%8E%E5%BC%95%E7%94%A8%E5%8E%9F%E7%90%86-2-7-7-%E6%B3%A8%E8%A7%A3%E7%89%88"><span class="toc-text">5.4. 服务暴露与引用原理 -2.7.7- 注解版</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-%E6%9C%8D%E5%8A%A1%E6%9A%B4%E9%9C%B2%E5%8E%9F%E7%90%86-xml-%E7%89%88%E2%AD%90%EF%B8%8F%F0%9F%94%B4"><span class="toc-text">5.5. 服务暴露原理 -xml 版⭐️🔴</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-1-%E5%B0%81%E8%A3%85-serviceBean"><span class="toc-text">5.5.1. 封装 serviceBean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-2-%E5%AE%9E%E7%8E%B0%E4%BA%86-%E3%80%90InitializingBean%E3%80%91"><span class="toc-text">5.5.2. 实现了 【InitializingBean】</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-2-1-afterpropertiesSet-%E4%BF%9D%E5%AD%98%E4%BF%A1%E6%81%AF%E5%88%B0-serviceBean"><span class="toc-text">5.5.2.1. afterpropertiesSet- 保存信息到 serviceBean</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-3-%E5%AE%9E%E7%8E%B0%E4%BA%86%E3%80%90-ApplicationListener%E3%80%91"><span class="toc-text">5.5.3. 实现了【 ApplicationListener】</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-1-onApplicationEvent-%E5%8A%A0%E8%BD%BD%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-text">5.5.3.1. onApplicationEvent- 加载注册中心的信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-2-%E5%B0%86%E7%9B%AE%E6%A0%87%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E7%B1%BB%E3%80%81%E6%8E%A5%E5%8F%A3%E3%80%81URL-%E7%AD%89%E4%BF%A1%E6%81%AF%E5%B0%81%E8%A3%85%E6%88%90-invoker-%E6%89%A7%E8%A1%8C%E5%99%A8"><span class="toc-text">5.5.3.2. 将目标服务实现类、接口、URL 等信息封装成 invoker 执行器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-3-protocol-export-warpperInvoker-%E6%9A%B4%E9%9C%B2-invoker"><span class="toc-text">5.5.3.3. protocol.export(warpperInvoker)- 暴露 invoker</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-5-3-3-1-RegistryProtocol-export-%E6%9A%B4%E9%9C%B2-Regisry"><span class="toc-text">5.5.3.3.1. RegistryProtocol.export- 暴露 Regisry</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#5-5-3-3-1-1-doLocalExport"><span class="toc-text">5.5.3.3.1.1. doLocalExport</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#5-5-3-3-1-2-DubboProtocol-export-%E6%9A%B4%E9%9C%B2-Dubbo-%E5%90%AF%E5%8A%A8-netty-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">5.5.3.3.1.2. DubboProtocol.export- 暴露 Dubbo- 启动 netty 服务器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-3-4-ProviderConsumerRegTable-registerProvider-%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1"><span class="toc-text">5.5.3.4. ProviderConsumerRegTable.registerProvider- 注册服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-%E6%9C%8D%E5%8A%A1%E5%BC%95%E7%94%A8%E5%8E%9F%E7%90%86-xml-%E7%89%88%E2%AD%90%EF%B8%8F%F0%9F%94%B4"><span class="toc-text">5.6. 服务引用原理 -xml 版⭐️🔴</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-1-%E5%AE%9E%E7%8E%B0%E4%BA%86-%E3%80%90FactoryBean%E3%80%91"><span class="toc-text">5.6.1. 实现了 【FactoryBean】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-2-RegistryProtocol-refer"><span class="toc-text">5.6.2. RegistryProtocol.refer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-3-DubboProtocol-refer"><span class="toc-text">5.6.3. DubboProtocol.refer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7-%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E5%8E%9F%E7%90%86-xml-%E7%89%88"><span class="toc-text">5.7. 服务调用原理 -xml 版</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-1-%E8%BF%9B%E5%85%A5-InvokerInvocationHandler"><span class="toc-text">5.7.1. 进入 InvokerInvocationHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-2-%E6%89%A7%E8%A1%8C-new-RpcInvocation-%E6%96%B9%E6%B3%95"><span class="toc-text">5.7.2. 执行 new RpcInvocation 方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-3-%E8%8E%B7%E5%8F%96%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%9C%BA%E5%88%B6"><span class="toc-text">5.7.3. 获取负载均衡机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-4-%E7%BB%8F%E8%BF%87%E5%A4%9A%E4%B8%AA-filter"><span class="toc-text">5.7.4. 经过多个 filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-5-DubboInvoker-%E6%96%B9%E6%B3%95%E4%B8%AD%E7%9A%84-doInvoke-%E6%96%B9%E6%B3%95"><span class="toc-text">5.7.5. DubboInvoker 方法中的 doInvoke 方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-6-currentClient-request"><span class="toc-text">5.7.6. currentClient.request</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-%E5%88%86%E5%B1%82%E8%AE%BE%E8%AE%A1"><span class="toc-text">6. 分层设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%8D%8F%E8%AE%AE"><span class="toc-text">7. 协议</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E4%B8%8E-SpringBoot-%E6%95%B4%E5%90%88"><span class="toc-text">8. 与 SpringBoot 整合</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-Dubbo-SPI-%E4%B8%8E-JDK-SPI-%E5%8C%BA%E5%88%AB"><span class="toc-text">9. Dubbo SPI 与 JDK SPI 区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-text">10. 面试题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-%E4%B8%8E-SpringCloud-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">10.1. 与 SpringCloud 的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-%E5%8A%A8%E6%80%81%E6%84%9F%E7%9F%A5%E6%9C%8D%E5%8A%A1%E4%B8%8B%E7%BA%BF"><span class="toc-text">10.2. 动态感知服务下线</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-%E5%AE%B9%E9%94%99%E6%9C%BA%E5%88%B6"><span class="toc-text">10.3. 容错机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-4-%E5%AF%B9-Dubbo-%E7%9A%84%E7%90%86%E8%A7%A3"><span class="toc-text">10.4. 对 Dubbo 的理解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-5-%E6%96%87%E5%AD%97%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-text">10.5. 文字面试题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%8F%82%E8%80%83%E4%B8%8E%E6%84%9F%E8%B0%A2"><span class="toc-text">11. 参考与感谢</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-Dubbo-%E6%95%99%E7%A8%8B-%E9%9B%B7%E4%B8%B0%E9%98%B3-%E5%B0%9A%E7%A1%85%E8%B0%B7"><span class="toc-text">11.1. Dubbo 教程 _ 雷丰阳 _ 尚硅谷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-1-%E8%A7%86%E9%A2%91"><span class="toc-text">11.1.1. 视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-2-%E8%B5%84%E6%96%99"><span class="toc-text">11.1.2. 资料</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98"><span class="toc-text">11.2. 黑马程序员</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-1-%E8%A7%86%E9%A2%91"><span class="toc-text">11.2.1. 视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-2-%E8%B5%84%E6%96%99"><span class="toc-text">11.2.2. 资料</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3-%E5%BE%AE%E6%9C%8D%E5%8A%A1-dubbo-%E5%92%8C-springcloud-%E5%A6%82%E4%BD%95%E6%8A%89%E6%8B%A9%EF%BC%9F"><span class="toc-text">11.3. 微服务 dubbo 和 springcloud 如何抉择？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-4-%E5%85%B6%E4%BB%96"><span class="toc-text">11.4. 其他</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-5-%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0%E6%91%98%E6%8A%84"><span class="toc-text">11.5. 技术文章摘抄</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-1-%E8%A7%86%E9%A2%91"><span class="toc-text">11.5.1. 视频</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-5-2-%E6%96%87%E6%A1%A3"><span class="toc-text">11.5.2. 文档</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-6-%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0"><span class="toc-text">11.6. 网络笔记</span></a></li></ol></li></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/012-%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98/%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98-%E9%A3%8E%E6%8E%A7%E7%B3%BB%E7%BB%9F-2%E3%80%81%E9%A3%8E%E6%8E%A7%E4%B8%AD%E5%8F%B0/" title="无题"><img src="https://picsum.photos/1920/1081" onerror='this.onerror=null,this.src="/null"' alt="无题"></a><div class="content"><a class="title" href="/2023/06/13/012-%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98/%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98-%E9%A3%8E%E6%8E%A7%E7%B3%BB%E7%BB%9F-2%E3%80%81%E9%A3%8E%E6%8E%A7%E4%B8%AD%E5%8F%B0/" title="无题">无题</a><time datetime="2023-06-13T23:32:43.044Z" title="发表于 2023-06-14 07:32:43">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-15%E3%80%81%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/" title="分布式专题-15、链路追踪"><img src="https://picsum.photos/1920/962" onerror='this.onerror=null,this.src="/null"' alt="分布式专题-15、链路追踪"></a><div class="content"><a class="title" href="/2023/06/13/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-15%E3%80%81%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/" title="分布式专题-15、链路追踪">分布式专题-15、链路追踪</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/013-%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/%E8%B5%84%E6%BA%90%E5%AF%BC%E8%88%AA/" title="资源导航"><img src="https://picsum.photos/1920/992" onerror='this.onerror=null,this.src="/null"' alt="资源导航"></a><div class="content"><a class="title" href="/2023/06/13/013-%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/%E8%B5%84%E6%BA%90%E5%AF%BC%E8%88%AA/" title="资源导航">资源导航</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-0%E3%80%81%E6%B1%87%E6%80%BB/" title="算法-0、汇总"><img src="https://picsum.photos/1920/972" onerror='this.onerror=null,this.src="/null"' alt="算法-0、汇总"></a><div class="content"><a class="title" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-0%E3%80%81%E6%B1%87%E6%80%BB/" title="算法-0、汇总">算法-0、汇总</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-1%E3%80%81%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/" title="算法-1、题目解析"><img src="https://picsum.photos/1920/1082" onerror='this.onerror=null,this.src="/null"' alt="算法-1、题目解析"></a><div class="content"><a class="title" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-1%E3%80%81%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/" title="算法-1、题目解析">算法-1、题目解析</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url('https://picsum.photos/1920/982')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Taylor Luo</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><script>(()=>{const o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo-taylorluo.vercel.app/",region:"ap-shanghai",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const o=document.getElementById("twikoo-count");o&&twikoo.getCommentsCount({envId:"https://twikoo-taylorluo.vercel.app/",region:"ap-shanghai",urls:[window.location.pathname],includeReply:!1}).then((function(t){o.innerText=t[0].count})).catch((function(o){console.error(o)}))})()},t=()=>{"object"!=typeof twikoo?getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(o):setTimeout(o,0)};t()})()</script></div><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="拼搏,自强,正直,自信" data-fontsize="15px" data-random="false" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>