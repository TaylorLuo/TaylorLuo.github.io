<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>框架源码专题-MySQL-2、MVCC | Taylor</title><meta name="keywords" content="MySQL,MVCC"><meta name="author" content="Taylor Luo"><meta name="copyright" content="Taylor Luo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. 隔离级别实现原理事务-1、Spring事务(本地事务)   对于「读未提交」隔离级别的事务来说，因为可以读到未提交事务修改的数据，所以直接读取版本链上最新的数据 对于「串行化」隔离级别的事务来说，通过加读写锁的方式来避免并行访问； 对于「读已提交」和「可重复读」隔离级别的事务来说，它们是通过 Read View 来实现的，它们的区别在于创建 Read View 的时机不同。      「读"><meta property="og:type" content="article"><meta property="og:title" content="框架源码专题-MySQL-2、MVCC"><meta property="og:url" content="https://taylorluo.github.io/2023/02/13/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-2%E3%80%81%E4%BA%8B%E5%8A%A1-MVCC-LBCC/index.html"><meta property="og:site_name" content="Taylor"><meta property="og:description" content="1. 隔离级别实现原理事务-1、Spring事务(本地事务)   对于「读未提交」隔离级别的事务来说，因为可以读到未提交事务修改的数据，所以直接读取版本链上最新的数据 对于「串行化」隔离级别的事务来说，通过加读写锁的方式来避免并行访问； 对于「读已提交」和「可重复读」隔离级别的事务来说，它们是通过 Read View 来实现的，它们的区别在于创建 Read View 的时机不同。      「读"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://unpkg.com/justlovesmile-img/cover3.jpg"><meta property="article:published_time" content="2023-02-13T16:00:00.000Z"><meta property="article:modified_time" content="2023-06-13T23:32:42.672Z"><meta property="article:author" content="Taylor Luo"><meta property="article:tag" content="MySQL"><meta property="article:tag" content="MVCC"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://unpkg.com/justlovesmile-img/cover3.jpg"><link rel="shortcut icon" href="https://gcore.jsdelivr.net/gh/code-anan/image/蜘蛛网万圣节.png"><link rel="canonical" href="https://taylorluo.github.io/2023/02/13/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-2%E3%80%81%E4%BA%8B%E5%8A%A1-MVCC-LBCC/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"框架源码专题-MySQL-2、MVCC",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-06-14 07:32:42"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise(((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)})),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/self/Kimbiedark.css"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Taylor" type="application/atom+xml"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/index.jpeg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">183</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">85</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url('https://unpkg.com/justlovesmile-img/cover3.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Taylor</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">框架源码专题-MySQL-2、MVCC</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-13T16:00:00.000Z" title="发表于 2023-02-14 00:00:00">2023-02-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-13T23:32:42.672Z" title="更新于 2023-06-14 07:32:42">2023-06-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL/">MySQL</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span><span class="post-meta-separator">|</span><span data-flag-title="框架源码专题-MySQL-2、MVCC"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2023/02/13/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-2%E3%80%81%E4%BA%8B%E5%8A%A1-MVCC-LBCC/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr><h1 id="1-隔离级别实现原理"><a href="#1-隔离级别实现原理" class="headerlink" title="1. 隔离级别实现原理"></a>1. 隔离级别实现原理</h1><a href="/2023/02/12/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E4%BA%8B%E5%8A%A1-1%E3%80%81Spring%E4%BA%8B%E5%8A%A1(%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1)/" title="事务-1、Spring事务(本地事务)">事务-1、Spring事务(本地事务)</a><ol><li>对于「读未提交」隔离级别的事务来说，因为可以读到未提交事务修改的数据，所以直接读取<span style="background-color:#f0f">版本链上最新的数据</span></li><li>对于「串行化」隔离级别的事务来说，通过<span style="background-color:#f0f">加读写锁</span>的方式来避免并行访问；</li><li>对于「读已提交」和「可重复读」隔离级别的事务来说，它们是通过 Read View 来实现的，它们的区别在于创建 Read View 的时机不同。</li></ol><blockquote><p><span style="background-color:#f0f">「读已提交」隔离级别是在「每个语句执行前」都会重新生成一个 Read View</span><br><span style="background-color:#f0f">「可重复读」隔离级别是「启动事务时」生成一个 Read View，然后整个事务期间都在用这个 Read View</span></p></blockquote><h1 id="2-事务实现原理⭐️🔴"><a href="#2-事务实现原理⭐️🔴" class="headerlink" title="2. 事务实现原理⭐️🔴"></a>2. 事务实现原理⭐️🔴</h1><p><span style="display:none">%%<br>▶1.🏡⭐️◼️【🌈费曼无敌🌈⭐️第一步⭐️】◼️⭐️-point-20230406-0712%%</span>❕ ^9cpr5j</p><p>Mysql 里面的事务，满足 ACID 特性。</p><ol><li>首先，A 表示 Atomic 原子性，也就是需要保证多个 DML 操作是原子的，要么都成功，要么都失败。那么，失败就意味着要对原本执行成功的数据进行回滚，所以 InnoDB 设计了一个 <code>undo log</code> 表，在事务执行的过程中，把修改之前的数据快照保存到 <code>undo log</code> 里面，一旦出现错误，就直接从 <code>undo log</code> 里面读取数据执行反向操作就行了。</li><li>其次，C 表示一致性，表示数据的<span style="background-color:#f0f">完整性约束没有被破坏</span>，这个更多是依赖于业务层面的保证，数据库本身也提供了一些，比如主键的唯一约束，字段长度和类型的保证等等。</li><li>接着，I 表示事物的隔离性，也就是多个并行事务对同一个数据进行操作的时候，如何避免多个事务的干扰导致数据混乱的问题。而 InnoDB 实现了 SQL92 的标准，提供了四种隔离级别的实现：<br>RU（未提交读） RC（已提交读） RR（可重复读）Serializable（串行化）<br><span style="background-color:#f0f">InnoDB 默认的隔离级别是 RR（可重复读），然后使用了 MVCC 机制解决了脏读和不可重复读的问题，然后使用了间隙锁的方式有效避免了幻读的问题</span>。</li><li>最后一个是 D，表示持久性，也就是只要事务提交成功，那对于这个数据的结果的影响一定是永久性的。不能因为宕机或者其他原因导致数据变更失效。理论上来说，事务提交之后直接把数据持久化到磁盘就行了</li></ol><p>但是因为随机磁盘 IO 的效率确实很低，所以 InnoDB 设计了 Buffer Pool 缓冲区来优化，也就是数据发生变更的时候先更新内存缓冲区，然后在合适的时机再持久化到磁盘。那在持久化这个过程中，如果数据库宕机，就会导致数据丢失，也就无法满足持久性了。<br>所以 InnoDB 引入了 <code>redo log</code> 文件，这个文件存储了数据被修改之后的值，当我们通过事务对数据进行变更操作的时候，除了修改内存缓冲区里面的数据以外，还会把本次修改的值追加到 <code>redo log</code> 里面。当提交事务的时候，直接把 <code>redo log</code> 日志刷到磁盘上持久化，一旦数据库出现宕机，在 Mysql 重启在以后可以直接用 <code>redo log</code> 里面保存的重写日志读取出来，再执行一遍从而保证持久性。<br>因此，事务的实现原理的核心本质就是如何满足 ACID 的，在 InnDB 里面用到了 MVCC、行锁表锁、<code>undo log</code>、<code>redo log</code> 等机制来保证。</p><h1 id="MVCC-并发控制原理"><a href="#MVCC-并发控制原理" class="headerlink" title="MVCC 并发控制原理"></a>MVCC 并发控制原理</h1><p>1、在并发读写数据库时，可以做到在读操作时不用阻塞写操作，写操作也不用阻塞读操作，从而提高数据库的并发读写的处理能力。<br>2、能实现读一致性，从而解决脏读、幻读、不可重复读等不可重复读，但是不能解决数据更新丢失的问题。<br>3、采用乐观锁或者悲观锁用来解决写和写的冲突，从而最大程度地去提高数据库的并发性能。</p><p>在 MVCC 中，通常不需要加锁来控制并发访问。相反，每个事务都可以读取已提交的快照，而不需要获得共享锁或排它锁。<br>在写操作的时候，MVCC 会使用一种叫为<span style="background-color:#f0f">“写时复制”（Copy-On-Write）</span>的技术，也就是在修改数据之前先将数据复制一份，从而创建一个新的快照。当一个事务需要修改数据时，MVCC 会首先检查修改数据的快照版本号是否与该事务的快照版本一致，如果一致则表示可以修改这条数据，否则该事务需要等待其他事务完成对该数据的修改。<br>另外，这个事物在新快照之上修改的结果，不会影响原始数据，其他事务可以继续读取原始数据的快照，从而解决了脏读、不可重复度问题。<br>所以，正是有了 MVCC 机制，让多个事务对同一条数据进行读写时，不需要加锁也不会出现读写冲突。</p><h1 id="3-MVCC-隔离级别原理"><a href="#3-MVCC-隔离级别原理" class="headerlink" title="3. MVCC 隔离级别原理"></a>3. MVCC 隔离级别原理</h1><p><span style="display:none">%%<br>▶5.🏡⭐️◼️【🌈费曼无敌🌈⭐️第一步⭐️】◼️⭐️-point-20230413-1910%%</span>❕ ^a59z9q</p><p>MVCC 全称 Multi-Version Concurrency Control，MVCC 是一种通过<span style="background-color:#0f0">增加版本冗余数据来实现并发控制的</span>方法，一般在数据库管理系统中，实现对数据库的并发访问，在编程语言中实现事务内存。<br>❕<span style="display:none">%%<br>1103-🏡⭐️◼️MySQL 隔离级别的实现原理◼️⭐️-point-20230214-1103%%</span></p><h2 id="3-1-隐藏字段"><a href="#3-1-隐藏字段" class="headerlink" title="3.1. 隐藏字段"></a>3.1. 隐藏字段</h2><p>&#x3D;&#x3D;除了我们正常业务涉及的字段外&#x3D;&#x3D;，InnoDB 在内部向数据库表中添加三个隐藏字段:</p><ul><li>DB_TRX_ID：6-byte 的事务 ID。插入或更新行的最后一个事务的事务 ID</li><li>DB_ROLL_PTR：7-byte 的回滚指针。就是指向对应某行记录的上一个版本，在 undo log 中使用。</li><li>DB_ROW_ID：6-byte 的隐藏主键。如果数据表中没有主键也没有非 null 列，那么 InnoDB 会自动生成单调递增的隐藏主键（表中有主键或者非 NULL 的 UNIQUE 键时都不会包含 DB_ROW_ID 列）。</li></ul><p>如上面的表没有设计 primary key,其中 id&#x2F;name&#x2F;city 是我们的业务字段，那么加上隐藏字段应该如下</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230214142029.png" alt="image.png"></p><p>为方便理解可以简称如下：</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230214110325.png" alt="image.png"></p><h2 id="3-2-undo-log-和-版本链"><a href="#3-2-undo-log-和-版本链" class="headerlink" title="3.2. undo log 和 版本链"></a>3.2. undo log 和 版本链</h2><h3 id="3-2-1-undo-log"><a href="#3-2-1-undo-log" class="headerlink" title="3.2.1. undo log"></a>3.2.1. undo log</h3><p>undo log 就是回滚日志，在 insert&#x2F;update&#x2F;delete 变更操作的时候生成的记录方便回滚。</p><h4 id="3-2-1-1-insert-undo-log"><a href="#3-2-1-1-insert-undo-log" class="headerlink" title="3.2.1.1. insert undo log"></a>3.2.1.1. insert undo log</h4><p>当进行 insert 操作的时候，产生的 undo log 只有在事务回滚的时候需求，如果不回滚在事务提交之后就会被删除。</p><h4 id="3-2-1-2-modify-undo-log"><a href="#3-2-1-2-modify-undo-log" class="headerlink" title="3.2.1.2. modify undo log"></a>3.2.1.2. modify undo log</h4><p>当进行 update 和 delete 的时候，产生的 undo log 不仅仅在事务回滚的时候需要，在快照读的时候也是需要的，所以不会立即删除，只有等不在用到这个日志的时候才会被 mysql purge 线程统一处理掉（delete 操作也只是打一个删除标记，并不是真正的删除）</p><h3 id="3-2-2-版本链"><a href="#3-2-2-版本链" class="headerlink" title="3.2.2. 版本链"></a>3.2.2. 版本链</h3><p>所谓的版本链就是<span style="background-color:#f0f">多个事务操作同一条记录</span>的时候<span style="background-color:#f0f">都会生成一些 undo 日志</span>，这些 undo 日志通过回滚指针串联在一起。</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230214141409.png" alt="image.png"></p><h2 id="3-3-ReadView"><a href="#3-3-ReadView" class="headerlink" title="3.3. ReadView"></a>3.3. ReadView</h2><p><span style="display:none">%%<br>▶6.🏡⭐️◼️【🌈费曼无敌🌈⭐️第一步⭐️】◼️⭐️-point-20230413-1916%%</span>❕ ^6sakz1</p><p>使用 READ COMMITTED 和 REPEATABLE READ 隔离级别的事务，除了 readview 还需要用到上文提到的版本链，核心问题是：</p><p><span style="background-color:#0f0">需要判断版本链中的哪个版本是允许当前事务可见的</span></p><p>ReadView 中主要包含 4 个比较重要的内容：</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230414124305.png" alt="image.png"></p><ol><li><strong>m_ids</strong>：表示在生成 ReadView 时<span style="background-color:#f0f">当前活跃的读写事务</span>的事务 id 列表。<br><strong>“活跃事务”指的就是，启动了但还没提交的事务</strong>。</li><li><strong>min_trx_id</strong>：表示在生成 ReadView 时当前系统中活跃的读写事务中最小的事务 id，也就是 m_ids 中的最小值。(up_limit_id)</li><li><strong>max_trx_id</strong>：表示生成 ReadView 时系统中应该分配给下一个事务的 id 值，也就是全局事务中最大的事务 id 值 + 1。 (low_limit_id)</li><li><strong>creator_trx_id</strong>：表示生成该 ReadView 的事务的事务 id。</li></ol><blockquote><pre><code>注意 max_trx_id 并不是 m_ids 中的最大值，事务 id 是递增分配的。比方说现在有 id 为 1，2，3 这三个事务，之后 id 为 3 的事务提交了。那么一个新的读事务在生成 ReadView 时，m_ids 就包括 1 和 2，min_trx_id 的值就是 1，max_trx_id 的值就是 4。
</code></pre></blockquote><h3 id="3-3-1-low-与-up"><a href="#3-3-1-low-与-up" class="headerlink" title="3.3.1. low 与 up"></a>3.3.1. low 与 up</h3><p><span style="display:none">%%<br>▶83.🏡⭐️◼️【🌈费曼无敌🌈⭐️第一步⭐️】◼️⭐️-point-20230306-2245%%</span>❕ ^yncd6p</p><p>其中<span style="background-color:#f0f">最早的</span>事务 ID 为 <code>up_limit_id</code>，<span style="background-color:#f0f">最迟的</span>事务 ID 为 <code>low_limit_id</code><br>❕<span style="display:none">%%<br>1457-🏡⭐️◼️low 与 up 的理解 ?🔜MSTM📝 up 表示最小的，最早出现的那个，low 的话指后面来的◼️⭐️-point-20230214-1457%%</span><br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230214145643.png" alt="image.png"></p><p><span style="background-color:#f0f">如何记忆：up→起得早的就排在前面，即前面提交的事务 id，数值比较小。</span> ^1xd5nv</p><h2 id="3-4-可见性判断⭐️🔴"><a href="#3-4-可见性判断⭐️🔴" class="headerlink" title="3.4. 可见性判断⭐️🔴"></a>3.4. 可见性判断⭐️🔴</h2><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230414123940.png" alt="image.png"></p><p><span style="background-color:#f0f">trx_id: 最后一次稳定事务 id，即刚刚提交的事务 id</span></p><ol><li><p>trx_id &lt; up_limit_id (即 min_id) <span style="background-color:#0f0">读之前已提交</span><br>表示这个版本的记录是在创建 Read View <strong>前</strong> 已经提交的事务生成的，所以该版本的记录对当前事务 <strong>可见</strong>。跳转到步骤 5；</p></li><li><p>trx_id &gt; low_limit_id (即 max_id) <span style="background-color:#0f0">读之后才启动</span><br>表示这个版本的记录是在创建 Read View <strong>后</strong> 才启动的事务生成的，所以该版本的记录对当前事务 <strong>不可见</strong>。跳转到步骤 4；</p></li><li><p>up_limit_id &lt;&#x3D; trx_id &lt;&#x3D; low_limit_id</p></li></ol><blockquote><p>需要判断 trx_id 是否在 m_ids 列表中：<br>1. 如果记录的 trx_id 在 m_ids 列表中，表示生成该版本记录的活跃事务依然活跃着（还没提交事务），所以该版本的记录对当前事务不可见。<br>2. 如果记录的 trx_id 不在 m_ids 列表中，表示生成该版本记录的活跃事务已经被提交，所以该版本的记录对当前事务可见。</p></blockquote><p>从 up_limit_id 到 low_limit_id 进行遍历，如果 trx_id 等于他们之中的某个事务 id 的话，表示该记录的最后一次修改尚未保存，跳转到步骤 4。否则跳转到步骤 5；</p><ol start="4"><li>从此记录的 DB_ROLL_PTR 指针所指向的 undo log（此记录的上一次修改，即上一个版本），将 undo log 的 DB_TRX_ID 赋值给 trx_id，跳转到步骤 1 重新开始计算可见性；<br><span style="background-color:#f0f">取上一个版本进行判断，拿着 readview 从版本链上，从上往下移动判断</span> ❕<span style="display:none">%%<br>1533-🏡⭐️◼️对版本链和 readview 可见性判断的理解◼️⭐️-point-20230214-1533%%</span></li><li>如果此记录的 DELELE_BIT 为 false，说明该记录未被删除，可以返回，否则不返回。</li></ol><blockquote><p><span style="background-color:#0f0">&gt; 一个事务只能看到第一次查询之前已经提交的事务以及当前事务的修改。</span><br><span style="background-color:#0f0">&gt; 一个事务不能看到当前事务第一次查询之后创建的事务，以及未提交的事务。</span></p></blockquote><h1 id="4-LBCC"><a href="#4-LBCC" class="headerlink" title="4. LBCC"></a>4. LBCC</h1><p>LBCC（Lock-Base Concurrency Control）基于锁的并发控制。在前面的文章中我们学习过 MVCC，我们知道 MVCC 基于多版本控制可以提升 mysql 的并发读写能力，但是不能完全解决幻读，以及并发写的问题（出现更新丢失）</p><h2 id="4-1-读取分类"><a href="#4-1-读取分类" class="headerlink" title="4.1. 读取分类"></a>4.1. 读取分类</h2><p><a target="_blank" rel="noopener" href="https://www.modb.pro/db/593096">https://www.modb.pro/db/593096</a><br>当多个事务同时操作同一份数据内容时，可以分为两种获取方式：当前读、快照读。<br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230214131739.png" alt="image.png"></p><h3 id="4-1-1-当前读-锁定读"><a href="#4-1-1-当前读-锁定读" class="headerlink" title="4.1.1. 当前读 (锁定读)"></a>4.1.1. 当前读 (锁定读)</h3><p>直接从磁盘或 buffer 中获取当前内容的最新数据，读到什么就是什么。根据隔离级别的不同期间会产生一些锁，防止并发场景下其他事务产生影响；</p><p>在官方叫做 Locking Reads（锁定读）：<br><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/innodb-locking-reads.html">https://dev.mysql.com/doc/refman/8.0/en/innodb-locking-reads.html</a></p><h3 id="4-1-2-快照读"><a href="#4-1-2-快照读" class="headerlink" title="4.1.2. 快照读"></a>4.1.2. <strong>快照读</strong></h3><p>简单的 SELECT 操作（不包括 lock in share mode,for update），根据隔离级别的不同，会在不同时机产生快照，事务读取的实际是快照内容，保证一致性的同时减少了锁之间的竞争；<br>官方叫做 Consistent Nonlocking Reads（一致性非锁定读取，也叫一致性读取）: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html">https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html</a></p><h2 id="4-2-RR-级别下并没有完全解决幻读"><a href="#4-2-RR-级别下并没有完全解决幻读" class="headerlink" title="4.2. RR 级别下并没有完全解决幻读"></a>4.2. RR 级别下并没有完全解决幻读</h2><p>❕<span style="display:none">%%<br>1319-🏡⭐️◼️为什么说 MySQL 的可重复读并没有完全解决幻读？◼️⭐️-point-20230214-1319%%</span></p><p>MySQL 在「可重复读」隔离级别下，可以很大程度上避免幻读现象的发生<span style="background-color:red">（注意是很大程度避免，并不是彻底避免）</span>，所以 MySQL 并不会使用「串行化」隔离级别来避免幻读现象的发生，因为使用「串行化」隔离级别会影响性能。</p><p><span style="background-color:#f0f">在 RR 级别下普通查询是快照读，并不会看到其他事务插入的数据。这种幻读情况只有在快照读与当前读混合使用的情况下才会出现，这部分也是争议比较多的地方。</span></p><p>然而当前读的定义就是能从 buffer 或磁盘获取到已提交数据的最新值，所以这跟事务的可见性其实并不矛盾。<br><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230216080646.png" alt="image.png"></p><p>案例一分析：事务 B 的两次读中间 A 有提交，如果 B 第二次读是当前读，就会发生幻读。因为当前读不是通过 readview 来判断可见性，而是直接读取缓存中的最新数据</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230216080900.png" alt="image.png"></p><h3 id="4-2-1-解决方案"><a href="#4-2-1-解决方案" class="headerlink" title="4.2.1. 解决方案"></a>4.2.1. 解决方案</h3><p><span style="background-color:#f0f"><strong>Innodb 引擎为了解决「可重复读」隔离级别使用「当前读」而造成的幻读问题，就引出了间隙锁</strong>。</span></p><h1 id="5-幻读总结"><a href="#5-幻读总结" class="headerlink" title="5. 幻读总结"></a>5. 幻读总结</h1><p>MySQL InnoDB 引擎的可重复读隔离级别（默认隔离级），根据不同的查询方式，分别提出了避免幻读的方案：</p><ul><li>针对 <strong>快照读</strong>（普通 select 语句），是通过 MVCC 方式解决了幻读。</li><li>针对 <strong>当前读</strong>（select … for update 等语句），是通过 next-key lock（记录锁 + 间隙锁）方式解决了幻读。</li></ul><p>举例两个发生幻读场景的例子：</p><p>第一个例子：对于快照读， MVCC 并不能完全避免幻读现象。因为当事务 A 更新了一条事务 B 插入的记录，那么事务 A 前后两次查询的记录条目就不一样了，所以就发生幻读。</p><p>第二个例子：对于当前读，如果事务开启后，并没有执行当前读，而是先快照读，然后这期间如果其他事务插入了一条记录，那么事务后续使用当前读进行查询的时候，就会发现两次查询的记录条目就不一样了，所以就发生幻读。</p><p>所以，<strong>MySQL 可重复读隔离级别并没有彻底解决幻读，只是很大程度上避免了幻读现象的发生。</strong></p><p>要避免这类特殊场景下发生幻读的现象的话，就要<span style="background-color:#f0f">尽量在开启事务之后，马上执行 select … for update 这类当前读的语句</span>，<span style="background-color:#0f0">因为它会对记录加 next-key lock，从而避免其他事务插入一条新记录。</span></p><p><strong>for update 案例</strong>：</p><h1 id="6-RC-与-RR-隔离级别的区别"><a href="#6-RC-与-RR-隔离级别的区别" class="headerlink" title="6. RC 与 RR 隔离级别的区别"></a>6. RC 与 RR 隔离级别的区别</h1><p>Repeatable Read 和 Read Committed 隔离级别都是基于 read view 来实现，不同之处在于：</p><ul><li><p>Repeatable Read<br>read view 是在执行事务中第一条 select 语句的瞬间创建，后续整个事务期间所有的 select 都是复用这个对象，所以能保证每次读取的一致性。（<strong>可重复读的语义</strong>）❕<span style="display:none">%%<br>1537-🏡⭐️◼️可重复读，复用第一次查询时使用的 readview。与读已提交不同的是，读已提交每次都会生成一个 readview，相当于动态维护了 m_ids 集合◼️⭐️-point-20230214-1537%%</span></p></li><li><p>Read Committed<br>事务中每条 select 语句都会创建 read view，这样就可以读取到其它事务已经提交的内容。</p></li></ul><blockquote><p>对于 InnoDB 来说，Repeatable Read 虽然比 Read Committed 隔离级别高，开销反而相对较小。</p></blockquote><h1 id="7-实战经验"><a href="#7-实战经验" class="headerlink" title="7. 实战经验"></a>7. 实战经验</h1><h1 id="8-参考与感谢"><a href="#8-参考与感谢" class="headerlink" title="8. 参考与感谢"></a>8. 参考与感谢</h1><p><a target="_blank" rel="noopener" href="https://www.modb.pro/db/593096">https://www.modb.pro/db/593096</a><br><a target="_blank" rel="noopener" href="https://juejin.cn/post/7020422614552150052">https://juejin.cn/post/7020422614552150052</a><br>可见性： <a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/1094075">https://developer.aliyun.com/article/1094075</a> ^zqsfcl<br><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903774071291917">https://juejin.cn/post/6844903774071291917</a> ^033zxt</p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230213230544.jpg" alt="image-20200201101126173"></p><p><img src="https://raw.githubusercontent.com/TaylorLuo/typora-imgs/master/img20230213230606.jpg" alt="image-20200201101626392"></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="https://taylorluo.github.io">Taylor Luo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://taylorluo.github.io/2023/02/13/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-2%E3%80%81%E4%BA%8B%E5%8A%A1-MVCC-LBCC/">https://taylorluo.github.io/2023/02/13/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-2%E3%80%81%E4%BA%8B%E5%8A%A1-MVCC-LBCC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://taylorluo.github.io" target="_blank">Taylor</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/MVCC/">MVCC</a></div><div class="post_share"><div class="social-share" data-image="https://unpkg.com/justlovesmile-img/cover3.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/02/14/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-3%E3%80%81redolog-undolog-binlog/"><img class="prev-cover" src="https://picsum.photos/1920/972" onerror='onerror=null,src="/null"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">框架源码专题-MySQL-3、redolog undolog binlog</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/12/001-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%93%E9%A2%98/%E5%85%B3%E9%94%AE%E5%AD%97%E5%92%8C%E6%8E%A5%E5%8F%A3-7%E3%80%81Throwable/"><img class="next-cover" src="https://picsum.photos/1920/1083" onerror='onerror=null,src="/null"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Java基础-关键字和接口-7、Throwable</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/12/31/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-1%E3%80%81%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/" title="框架源码专题-MySQL-1、基本原理"><img class="cover" src="https://unpkg.com/justlovesmile-img/cover2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-01-01</div><div class="title">框架源码专题-MySQL-1、基本原理</div></div></a></div><div><a href="/2023/02/14/002-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E4%B8%93%E9%A2%98/MySQL-3%E3%80%81redolog-undolog-binlog/" title="框架源码专题-MySQL-3、redolog undolog binlog"><img class="cover" src="https://picsum.photos/1920/972" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-15</div><div class="title">框架源码专题-MySQL-3、redolog undolog binlog</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/index.jpeg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Taylor Luo</div><div class="author-info__description">人生海海 不忘初心</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">183</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">85</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-text">1. 隔离级别实现原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E2%AD%90%EF%B8%8F%F0%9F%94%B4"><span class="toc-text">2. 事务实现原理⭐️🔴</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MVCC-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86"><span class="toc-text">MVCC 并发控制原理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-MVCC-%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%8E%9F%E7%90%86"><span class="toc-text">3. MVCC 隔离级别原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E9%9A%90%E8%97%8F%E5%AD%97%E6%AE%B5"><span class="toc-text">3.1. 隐藏字段</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-undo-log-%E5%92%8C-%E7%89%88%E6%9C%AC%E9%93%BE"><span class="toc-text">3.2. undo log 和 版本链</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-undo-log"><span class="toc-text">3.2.1. undo log</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-1-insert-undo-log"><span class="toc-text">3.2.1.1. insert undo log</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-2-modify-undo-log"><span class="toc-text">3.2.1.2. modify undo log</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E7%89%88%E6%9C%AC%E9%93%BE"><span class="toc-text">3.2.2. 版本链</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-ReadView"><span class="toc-text">3.3. ReadView</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-1-low-%E4%B8%8E-up"><span class="toc-text">3.3.1. low 与 up</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E5%8F%AF%E8%A7%81%E6%80%A7%E5%88%A4%E6%96%AD%E2%AD%90%EF%B8%8F%F0%9F%94%B4"><span class="toc-text">3.4. 可见性判断⭐️🔴</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-LBCC"><span class="toc-text">4. LBCC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E8%AF%BB%E5%8F%96%E5%88%86%E7%B1%BB"><span class="toc-text">4.1. 读取分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-%E5%BD%93%E5%89%8D%E8%AF%BB-%E9%94%81%E5%AE%9A%E8%AF%BB"><span class="toc-text">4.1.1. 当前读 (锁定读)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-%E5%BF%AB%E7%85%A7%E8%AF%BB"><span class="toc-text">4.1.2. 快照读</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-RR-%E7%BA%A7%E5%88%AB%E4%B8%8B%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%AE%8C%E5%85%A8%E8%A7%A3%E5%86%B3%E5%B9%BB%E8%AF%BB"><span class="toc-text">4.2. RR 级别下并没有完全解决幻读</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">4.2.1. 解决方案</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E5%B9%BB%E8%AF%BB%E6%80%BB%E7%BB%93"><span class="toc-text">5. 幻读总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-RC-%E4%B8%8E-RR-%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">6. RC 与 RR 隔离级别的区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%AE%9E%E6%88%98%E7%BB%8F%E9%AA%8C"><span class="toc-text">7. 实战经验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E5%8F%82%E8%80%83%E4%B8%8E%E6%84%9F%E8%B0%A2"><span class="toc-text">8. 参考与感谢</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/012-%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98/%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98-%E9%A3%8E%E6%8E%A7%E7%B3%BB%E7%BB%9F-2%E3%80%81%E9%A3%8E%E6%8E%A7%E4%B8%AD%E5%8F%B0/" title="无题"><img src="https://picsum.photos/1920/1081" onerror='this.onerror=null,this.src="/null"' alt="无题"></a><div class="content"><a class="title" href="/2023/06/13/012-%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98/%E7%BB%8F%E9%AA%8C%E4%B8%93%E9%A2%98-%E9%A3%8E%E6%8E%A7%E7%B3%BB%E7%BB%9F-2%E3%80%81%E9%A3%8E%E6%8E%A7%E4%B8%AD%E5%8F%B0/" title="无题">无题</a><time datetime="2023-06-13T23:32:43.044Z" title="发表于 2023-06-14 07:32:43">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-15%E3%80%81%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/" title="分布式专题-15、链路追踪"><img src="https://picsum.photos/1920/962" onerror='this.onerror=null,this.src="/null"' alt="分布式专题-15、链路追踪"></a><div class="content"><a class="title" href="/2023/06/13/005-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%93%E9%A2%98-15%E3%80%81%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA/" title="分布式专题-15、链路追踪">分布式专题-15、链路追踪</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/013-%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/%E8%B5%84%E6%BA%90%E5%AF%BC%E8%88%AA/" title="资源导航"><img src="https://picsum.photos/1920/992" onerror='this.onerror=null,this.src="/null"' alt="资源导航"></a><div class="content"><a class="title" href="/2023/06/13/013-%E7%9F%A5%E8%AF%86%E7%AE%A1%E7%90%86/%E8%B5%84%E6%BA%90%E5%AF%BC%E8%88%AA/" title="资源导航">资源导航</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-0%E3%80%81%E6%B1%87%E6%80%BB/" title="算法-0、汇总"><img src="https://picsum.photos/1920/972" onerror='this.onerror=null,this.src="/null"' alt="算法-0、汇总"></a><div class="content"><a class="title" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-0%E3%80%81%E6%B1%87%E6%80%BB/" title="算法-0、汇总">算法-0、汇总</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-1%E3%80%81%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/" title="算法-1、题目解析"><img src="https://picsum.photos/1920/1082" onerror='this.onerror=null,this.src="/null"' alt="算法-1、题目解析"></a><div class="content"><a class="title" href="/2023/06/13/014-AI%E7%AE%97%E6%B3%95%E4%B8%93%E9%A2%98/%E7%AE%97%E6%B3%95-1%E3%80%81%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90/" title="算法-1、题目解析">算法-1、题目解析</a><time datetime="2023-06-13T16:00:00.000Z" title="发表于 2023-06-14 00:00:00">2023-06-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url('https://unpkg.com/justlovesmile-img/cover3.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Taylor Luo</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><div class="js-pjax"><script>(()=>{const o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo-taylorluo.vercel.app/",region:"ap-shanghai",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const o=document.getElementById("twikoo-count");o&&twikoo.getCommentsCount({envId:"https://twikoo-taylorluo.vercel.app/",region:"ap-shanghai",urls:[window.location.pathname],includeReply:!1}).then((function(t){o.innerText=t[0].count})).catch((function(o){console.error(o)}))})()},t=()=>{"object"!=typeof twikoo?getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(o):setTimeout(o,0)};t()})()</script></div><script defer id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="拼搏,自强,正直,自信" data-fontsize="15px" data-random="false" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>